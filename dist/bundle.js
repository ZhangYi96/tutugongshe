!function(t){var i={};function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)e.d(s,n,function(i){return t[i]}.bind(null,n));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="dist/",e(e.s=0)}([function(t,i,e){"use strict";e.r(i);class s{constructor(t="",i,e,s,n,h,o,a=0,r=0){this.img=new Image,this.img.src=t,this.sx=i,this.sy=e,this.swidth=s,this.sheight=n,this.x=a,this.y=r,this.width=h,this.height=o,this.visible=!0}drawToCanvas(t){this.visible&&t.drawImage(this.img,this.sx,this.sy,this.swidth,this.sheight,this.x,this.y,this.width,this.height)}isCollideWith(t){let i=t.x+t.width/2,e=t.y+t.height/2;return!(!this.visible||!t.visible)&&!!(i>=this.x&&i<=this.x+this.width&&e>=this.y&&e<=this.y+this.height)}}const n=document.documentElement.clientWidth||document.body.clientWidth,h=document.documentElement.clientHeight||document.body.clientHeight,o=1920;let a=1080/n;class r extends s{constructor(t,i,e,s,n){super(i,0,0,1080,1920,0,0,1080/a,o/a),this.sizeW=e,this.sizeH=s,this.sWidth=1080,this.sHeight=1920,this.initx=n,this.minX=0,this.maxX=e-1080,this.render(t)}update(t){this.x+=t,this.x=this.x<this.minX?this.minX:this.x,this.x=this.x>this.maxX?this.maxX:this.x}init(){this.x=this.initx}render(t){t.drawImage(this.img,this.x,0,this.sWidth,this.sHeight,0,0,n,h)}isIntheExtent(t){return this.x+t>=this.minX&&this.x+t<=this.maxX}}const c=document.documentElement.clientWidth||document.body.clientWidth,d=document.documentElement.clientHeight||document.body.clientHeight;let u=1080/c;class l extends s{constructor(t,i,e,s,n,h){super(e,0,0,n,h,n/u,h/u),this.points=i,this.y=d*s[1],this.x=c*s[0],this.image=new Image,this.image.src=t,this.sx=this.points[0][0],this.sy=this.points[0][1],this.count=0}update(t,i=-1,e=-1){this.count<this.points.length?(this.y=d*t[1],this.x=c*t[0],this.sx=this.points[this.count][0],this.sy=this.points[this.count][1],this.count++):(this.y=d*t[1],this.x=c*t[0],this.img=this.image,-1==i?this.visible=!1:(this.visible=!0,this.sx=i,this.sy=e))}}const m=document.documentElement.clientWidth||document.body.clientWidth,p=document.documentElement.clientHeight||document.body.clientHeight;let v=1080/m;class g extends s{constructor(t,i,e,s,n,h,o,a,r){super(t,i,e,s,n,h,o),this.x=m*a,this.y=p*r,this.initsx=i,this.initsy=e,this.initx=m*a}fresh(t){this.x-=t/v}init(){this.x=this.initx}update(t=-1,i=-1){-1==t?(this.sx=this.initsx,this.sy=this.initsy):(this.sx=t,this.sy=i)}}const w=document.documentElement.clientWidth||document.body.clientWidth,y=document.documentElement.clientHeight||document.body.clientHeight,T=1080/w,f=1920/y;class b extends s{constructor(t,i,e,s,n,h){super(t,i[0],i[1],e[0],e[1],e[0]/T,e[1]/f),this.x1=i[0],this.x2=h[0],this.y1=i[1],this.y2=h[1],this.rect=[e[0],e[1]],this.isClearance=e[4],this.person=s,this.words=n;var o=w/2,a=y/2;this.x=o+this.width*e[2],this.y=a-this.height*e[3],this.initx=o+this.width*e[2],this.touched=!1}update(t){this.x-=t/T}init(){this.touched=!1,this.x=this.initx,this.sx=this.x1,this.sy=this.y1}initEvent(){canvas.addEventListener("touchend",(t=>{t.preventDefault()}).bind(this)),canvas.addEventListener("touchstart",(t=>{t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.checkIsFingerOnThis(i,e)?this.touched=!0:this.touched=!1}).bind(this))}updateImg(t){var i=new Image;i.src=t,this.img=i}drawToCanvas(t){1==this.touched?(this.sx=this.x2,this.sy=this.y2,0!=this.x2&&0!=this.y2&&super.drawToCanvas(t)):(this.sx=this.x1,this.sy=this.y1,this.swidth=this.rect[0],this.sheight=this.rect[1],super.drawToCanvas(t))}checkIsFingerOnThis(t,i){return!!(t>=this.x-0&&i>=this.y-0&&t<=this.x+this.width+0&&i<=this.y+this.height+0)}removeListener(){canvas.removeEventListener("touchstart",this.touchstart)}}const I=document.documentElement.clientWidth||document.body.clientWidth,x=document.documentElement.clientHeight||document.body.clientHeight,F=1080/I,E=1920/x;class L extends s{constructor(t,i,e,s,n){super(t,i[0],i[1],e,s,e/F,s/E);this.initx=I*n[0],this.x=I*n[0],this.y=x*n[1]}init(){this.touched=!1,this.x=this.initx}update(t){this.y-=t/E}checkIsFingerOnThis(t,i){return!!(t>=this.x-0&&i>=this.y-0&&t<=this.x+this.width+0&&i<=this.y+this.height+0)}}canvas.getContext("2d");const C=document.documentElement.clientWidth||document.body.clientWidth,M=document.documentElement.clientHeight||document.body.clientHeight,A=1080/C,S=1920/M;let k=["./images/Score/Score4.png","./images/Score/Score5.png"],B=[[[810,2],[608,2],[406,2],[204,2],[2,2]],[[2,512],[2,410],[2,308],[2,206],[2,104],[2,2]]],H=200,W=100;class O extends s{constructor(t){var i=B[t][0][0],e=B[t][0][1];super(k[t],i,e,H,W,H/A,W/S,0,0),this.points=B[t];this.x=C-this.width,this.y=0,this.type=t}update(t){this.sx=this.points[t][0],this.sy=this.points[t][1]}}let X=canvas.getContext("2d");document.documentElement.clientWidth||document.body.clientWidth;const D=document.documentElement.clientHeight||document.body.clientHeight;const Y=document.documentElement.clientWidth||document.body.clientWidth,R=document.documentElement.clientHeight||document.body.clientHeight,q=1080/Y,P=1920/R;class j extends s{constructor(t,i,e,s,n){super(i,0,0,1080,1920,1080/q,1920/P),this.sWidth=1080,this.sHeight=1920,this.inity=n,this.minY=0,this.maxY=s-1920,this.render(t)}update(t){this.y+=t,this.y=this.y<this.minY?this.minY:this.y,this.y=this.y>this.maxY?this.maxY:this.y}init(){this.y=this.inity}render(t){t.drawImage(this.img,0,this.y,this.sWidth,this.sHeight,0,0,Y,R)}isIntheExtent(t){return this.y+t>=this.minY&&this.y+t<=this.maxY}}document.documentElement.clientWidth||document.body.clientWidth;const G=1920/(document.documentElement.clientHeight||document.body.clientHeight);let _=canvas.getContext("2d");class z{init(t){this.lasty=0,this.BG=new j(_,t,1080,5e3,0),this.returnBtn=new L("images/setting/Setting.png",[2,150],306,85,[.32,2.46]),this.bindLoop=this.loop.bind(this),this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.initevent()}loop(){this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.render()}render(){this.BG.render(_),this.returnBtn.drawToCanvas(_),1==this.clickType&&(window.cancelAnimationFrame(this.aniId),canvas.removeEventListener("touchstart",this.touchstart),canvas.removeEventListener("touchmove",this.touchmove),ct.restart())}returnEvent(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;console.log(At.clickType),this.returnBtn.checkIsFingerOnThis(i,e)&&(this.clickType=1),this.lasty=e}eventTouchmove(t){t.preventDefault();let i=t.touches[0].clientY;var e=(this.lasty-i)*G;console.log("移动"+e),this.BG.isIntheExtent(e)&&(this.BG.update(e),this.returnBtn.update(e),this.lasty=i)}initevent(){this.touchstart=this.returnEvent.bind(this),canvas.addEventListener("touchstart",this.touchstart),this.touchmove=this.eventTouchmove.bind(this),canvas.addEventListener("touchmove",this.touchmove)}}const J=document.documentElement.clientWidth||document.body.clientWidth,K=document.documentElement.clientHeight||document.body.clientHeight,N=1080/J,Q=1920/K;let U=canvas.getContext("2d");class V{constructor(){this.atlas=new Image,this.onImg=[310,150],this.offImg=[548,2]}init(t){this.clickType=-1,this.atlas.src=t,this.bgMusic=new L("images/setting/Setting.png",this.onImg,289,81,[.55,.22]),this.clickMusic=new L("images/setting/Setting.png",this.onImg,289,81,[.55,.3]),this.returnBtn=new L("images/setting/Setting.png",[422,2],124,124,[0,0]),this.touchstart=this.completetouch.bind(this),this.bindLoop=this.loop.bind(this),canvas.addEventListener("touchstart",this.touchstart),this.aniId=window.requestAnimationFrame(this.bindLoop,canvas)}loop(){this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.render()}render(){U.drawImage(this.atlas,0,0,1080,1920,0,0,1080/N,1920/Q),1==kt.isPlayBgm?(this.bgMusic.sx=this.onImg[0],this.bgMusic.sy=this.onImg[1]):(this.bgMusic.sx=this.offImg[0],this.bgMusic.sy=this.offImg[1]),this.bgMusic.drawToCanvas(U),1==kt.isPlayShoot?(this.clickMusic.sx=this.onImg[0],this.clickMusic.sy=this.onImg[1]):(this.clickMusic.sx=this.offImg[0],this.clickMusic.sy=this.offImg[1]),this.clickMusic.drawToCanvas(U),this.returnBtn.drawToCanvas(U),3==this.clickType&&(window.cancelAnimationFrame(this.aniId),canvas.removeEventListener("touchstart",this.touchstart),ct.restart())}completetouch(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.bgMusic.checkIsFingerOnThis(i,e)&&(console.log("bgM"),1==kt.isPlayBgm?kt.isPlayBgm=0:kt.isPlayBgm=1,kt.playBgm()),this.clickMusic.checkIsFingerOnThis(i,e)&&(1==kt.isPlayShoot?kt.isPlayShoot=0:kt.isPlayShoot=1),this.returnBtn.checkIsFingerOnThis(i,e)&&(this.clickType=3)}}const Z=document.documentElement.clientWidth||document.body.clientWidth,$=document.documentElement.clientHeight||document.body.clientHeight,tt=1080/Z,it=1920/$;let et=canvas.getContext("2d"),st="./images/ChooseMission/ChooseBG.png",nt=[[2,646],[388,324],[2,324],[388,2],[2,2]];const ht=document.documentElement.clientWidth||document.body.clientWidth,ot=document.documentElement.clientHeight||document.body.clientHeight,at=1080/ht,rt=1920/ot,ct=new class{init(){this.atlas=new Image,this.atlas.src=st,this.miss=[],this.fanwaiScene=new z,this.settingScene=new V;for(var t=0;t<nt.length;t++){var i=Math.floor(t/2),e=t%2,s=new L("images/ChooseMission/ChooseMission.png",nt[t],384,320,[.136+.38*e,.21+.17*i]);this.miss.push(s)}this.chooseMission=-1,this.fanwai=new L("images/Setting/Setting.png",[107,2],103,146,[.1,.91]),this.egg=new L("images/Setting/Setting.png",[317,2],103,146,[.33,.91]),this.test=new L("images/Setting/Setting.png",[212,2],103,146,[.57,.91]),this.setting=new L("images/Setting/Setting.png",[2,2],103,146,[.8,.91]),this.bindLoop=this.loop.bind(this),this.restart()}restart(){this.chooseMission=-1,this.settingBtn=-1,this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.touchstart=this.choose.bind(this),canvas.addEventListener("touchstart",this.touchstart)}loop(){this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.render()}choose(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;for(var s=0;s<this.miss.length;s++)if(this.miss[s].checkIsFingerOnThis(i,e)&&s<4){this.chooseMission=s;break}this.fanwai.checkIsFingerOnThis(i,e)&&(this.settingBtn=1),this.setting.checkIsFingerOnThis(i,e)&&(this.settingBtn=2),this.test.checkIsFingerOnThis(i,e)&&(window.location.href="http://www.baidu.com"),console.log("选择关卡:"+this.chooseMission)}render(){et.drawImage(this.atlas,0,0,1080,1920,0,0,1080/tt,1920/it);for(var t=0;t<this.miss.length;t++)this.miss[t].drawToCanvas(et);this.egg.drawToCanvas(et),this.test.drawToCanvas(et),this.fanwai.drawToCanvas(et),this.setting.drawToCanvas(et),this.chooseMission>-1&&(console.log("choose to mission"),window.cancelAnimationFrame(this.aniId),canvas.removeEventListener("touchstart",this.touchstart),Mt[this.chooseMission].restart()),1==this.settingBtn?(console.log("fanwai Btn clcik"),window.cancelAnimationFrame(this.aniId),canvas.removeEventListener("touchstart",this.touchstart),this.fanwaiScene.init("./images/ChooseMission/fanwai.png")):2==this.settingBtn&&(console.log("setting Btn clcik"),window.cancelAnimationFrame(this.aniId),canvas.removeEventListener("touchstart",this.touchstart),this.settingScene.init("./images/setting/BG.png"))}};let dt=canvas.getContext("2d"),ut="./images/Begin/BG.png";let lt=canvas.getContext("2d");document.documentElement.clientWidth||document.body.clientWidth;const mt=document.documentElement.clientHeight||document.body.clientHeight;let pt=canvas.getContext("2d");document.documentElement.clientWidth||document.body.clientWidth;const vt=document.documentElement.clientHeight||document.body.clientHeight;let gt=canvas.getContext("2d");document.documentElement.clientWidth||document.body.clientWidth;const wt=document.documentElement.clientHeight||document.body.clientHeight;const yt=document.documentElement.clientWidth||document.body.clientWidth,Tt=document.documentElement.clientHeight||document.body.clientHeight,ft=1080/yt,bt=1920/Tt;let It,xt=canvas.getContext("2d");e.d(i,"Mission",function(){return Mt}),e.d(i,"complete",function(){return At}),e.d(i,"start",function(){return St}),e.d(i,"music",function(){return kt});var Ft=document.getElementById("canvas");const Et=document.documentElement.clientWidth||document.body.clientWidth,Lt=document.documentElement.clientHeight||document.body.clientHeight;Ft.width=Et,Ft.height=Lt;const Ct=new class{constructor(){this.aniId=0,this.MissionId=1,this.personalHighScore=null,this.scale=1920/mt,this.keyImg="./images/Mission2/object.png",this.lastx=0,this.init()}init(){var t=[[[361,788],[0,0],[1208,2],[749,958]],[[480,478],[1,583],[1610,2],[1,1596]],[[595,788],[0,0],[2,2],[1,958]],[[1,893],[0,0],[1208,2],[749,639]],[[361,583],[0,0],[404,2],[1,1277]],[[1,1],[0,0],[1208,2],[749,1277]]],i=[[232,200,-.3,-1.79,0],[279,308,4.2,1.5,1],[129,177,14.5,-2,1],[358,95,7.9,2,1],[98,201,14.5,-1.64,1],[477,580,5,-.4,0]];this.isReturn=-1,this.bg=new r(lt,"images/Mission2/BG2.png",4005,1920,0);for(var e=[],s=0;s<t.length;s++){var n=new b(this.keyImg,t[s][0],i[s],t[s][2],t[s][3],t[s][1]);e.push(n)}this.spritesForType2=e,this.women=new b("./images/Mission2/object.png",[480,1],[283,475,-1,.7,0],[0,0],[-1,-1],[-1,-1]),this.player=new g("./images/Mission2/Mission2person.png",1208,2,400,930,400/this.scale,930/this.scale,0,.5),this.welcome=new l("./images/Mission2/word.png",[[1,1],[749,1],[1,320],[749,320],[1,639]],"./images/Mission2/word.png",[.3,.7],746,317),this.returnBtn=new L("images/setting/Setting.png",[422,2],124,124,[0,0]),this.scoreImg=new O(0)}restart(){this.isReturn=-1,this.welcome.count=0,this.scores=[0,0,0,0],this.bindLoop=this.loop.bind(this);for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].init();this.women.init(),this.hasEventBind=!1,this.bg.init(),this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.initevent()}render(){if(1==this.isReturn&&(this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),ct.restart()),lt.clearRect(0,0,canvas.width,canvas.height),this.isSuccess()<this.scores.length){this.bg.render(lt),this.women.drawToCanvas(lt);for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].drawToCanvas(lt);this.welcome.drawToCanvas(lt),this.player.drawToCanvas(lt),this.scoreImg.drawToCanvas(lt)}else this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),At.init("./images/extra/complete2.png",this.MissionId),canvas.addEventListener("touchstart",At.touchstart);if(this.women.touched&&(this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),At.init("./images/extra/fail2.png",this.MissionId),canvas.addEventListener("touchstart",At.touchstart)),5==this.welcome.count){for(t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].initEvent();this.women.initEvent(),this.welcome.count++}this.returnBtn.drawToCanvas(lt)}completetouch(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.completeScene.again.checkIsFingerOnThis(i,e)&&(canvas.removeEventListener("touchstart",this.touchstart),this.restart())}loop(){this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.render()}initevent(){this.touchstart=this.eventTouchstart.bind(this),canvas.addEventListener("touchstart",this.touchstart),this.touchend=this.eventTouchend.bind(this),canvas.addEventListener("touchend",this.touchend),this.touchmove=this.eventTouchmove.bind(this),canvas.addEventListener("touchmove",this.touchmove)}isSuccess(){var t=0;return this.scores.forEach(function(i){t+=i}),t}eventTouchstart(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.lastx=i,this.returnBtn.checkIsFingerOnThis(i,e)&&(this.isReturn=1)}eventTouchend(t){t.preventDefault();var i=-1;if(this.welcome.count<5)this.welcome.count<3?this.welcome.update([.4,.3]):this.welcome.update([.3,.7]);else{for(var e=[-1,-1],s=[-1,-1],n=!1,h=0;h<this.spritesForType2.length;h++)1==this.spritesForType2[h].isClearance&&i++,this.spritesForType2[h].touched&&(1==this.spritesForType2[h].isClearance&&(this.scores[i]=1),e=this.spritesForType2[h].person,s=this.spritesForType2[h].words,n=!0);n||(i++,i++),this.player.update(e[0],e[1]),this.welcome.update([.3,.7],s[0],s[1])}this.scoreImg.update(this.isSuccess())}eventTouchmove(t){if(t.preventDefault(),this.welcome.count>4){let s=t.touches[0].clientX;var i=(this.lastx-s)*this.scale;if(console.log("移动"+i),this.bg.isIntheExtent(i)){this.bg.update(i);for(var e=0;e<this.spritesForType2.length;e++)this.spritesForType2[e].update(i);this.women.update(i),this.lastx=s}}}removeAllTouchListner(){if(canvas.removeEventListener("touchstart",this.touchstart),canvas.removeEventListener("touchend",this.touchend),canvas.removeEventListener("touchmove",this.touchmove),void 0!==this.spritesForType2){for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].removeListener();this.women.removeListener()}}},Mt=[new class{constructor(){this.aniId=0,this.MissionId=0,this.personalHighScore=null,this.scale=1920/D,this.keyImg="./images/Mission1/object.png",this.lastx=0,this.init()}init(){this.rightwindow=new b(this.keyImg,[631,1],[313,573,.42,.5],[-1,-1],[-1,-1],[946,1]),this.fly=new b(this.keyImg,[839,861],[64,74,3.5,1,1],[855,1],[1,639],[0,0]),this.fly.visible=!1;var t=[[[839,576],[1113,576],[1,1],[749,639]],[[1,576],[420,576],[855,938],[1,320]],[[1370,351],[0,0],[428,1],[1,1]],[[906,861],[0,0],[428,1],[749,1]],[[1261,351],[0,0],[1,938],[749,320]],[[1261,201],[0,0],[428,1],[749,1277]],[[1,1],[316,1],[-1,-1],[-1,-1]]],i=[[272,283,2.9,1.3,1],[417,361,-3.1,.38,1],[59,118,13,.82,0],[112,50,9,.61,0],[107,105,19.5,-1.8,1],[137,148,7.8,-1,0],[313,573,-.5,.5,0]];this.isReturn=-1,this.bg=new r(X,"images/Mission1/BG.png",4e3,1920,1080),this.fail=new b(this.keyImg,[1261,1],[176,198,7,2,0],[0,0],[0,1200],[340,140]);for(var e=[],s=0;s<t.length;s++){var n=new b(this.keyImg,t[s][0],i[s],t[s][2],t[s][3],t[s][1]);e.push(n)}this.spritesForType2=e,this.player=new g("./images/Mission1/person.png",428,938,425,935,425/this.scale,935/this.scale,0,.5),this.welcome=new l("./images/Mission1/word.png",[[1,958],[1,1277],[1,1596],[1,958]],"images/Mission1/word.png",[.3,.7],746,317),this.returnBtn=new L("images/setting/Setting.png",[422,2],124,124,[0,0]),this.scoreImg=new O(0)}restart(){this.isReturn=-1,this.welcome.count=0,this.scores=[0,0,0,0],this.bindLoop=this.loop.bind(this);for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].init();this.fly.init(),this.rightwindow.init(),this.fail.init(),this.hasEventBind=!1,this.bg.init(),this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.initevent()}render(){if(1==this.isReturn&&(this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),ct.restart()),X.clearRect(0,0,canvas.width,canvas.height),this.isSuccess()<this.scores.length){this.bg.render(X);for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].drawToCanvas(X);this.fail.drawToCanvas(X),this.welcome.drawToCanvas(X),this.rightwindow.drawToCanvas(X),this.fly.drawToCanvas(X),this.player.drawToCanvas(X),this.scoreImg.drawToCanvas(X)}else this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),At.init("./images/extra/complete1.png",this.MissionId),canvas.addEventListener("touchstart",At.touchstart);if(1==this.fail.touched&&(this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),At.init("./images/extra/fail1.png",this.MissionId),canvas.addEventListener("touchstart",At.touchstart)),4==this.welcome.count){for(t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].initEvent();this.rightwindow.initEvent(),this.fly.initEvent(),this.fail.initEvent(),this.welcome.count=5}this.returnBtn.drawToCanvas(X)}loop(){this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.render()}initevent(){this.touchstart=this.eventTouchstart.bind(this),canvas.addEventListener("touchstart",this.touchstart),this.touchend=this.eventTouchend.bind(this),canvas.addEventListener("touchend",this.touchend),this.touchmove=this.eventTouchmove.bind(this),canvas.addEventListener("touchmove",this.touchmove)}isSuccess(){var t=0;return this.scores.forEach(function(i){t+=i}),t}eventTouchstart(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.lastx=i,this.returnBtn.checkIsFingerOnThis(i,e)&&(this.isReturn=1)}eventTouchend(t){t.preventDefault(),console.log("touchend");var i=-1;if(this.welcome.count<4)this.welcome.update([.3,.7]);else{for(var e=[-1,-1],s=[-1,-1],n=0;n<this.spritesForType2.length;n++)1==this.spritesForType2[n].isClearance&&i++,this.spritesForType2[n].touched&&(1==this.spritesForType2[n].isClearance&&(this.scores[i]=1),e=this.spritesForType2[n].person,s=this.spritesForType2[n].words);i++,this.fly.touched&&(this.scores[i]=1,e=this.fly.person,s=this.fly.words),this.rightwindow.touched?this.fly.visible=!0:this.fly.visible=!1,this.player.update(e[0],e[1]),this.welcome.update([.3,.7],s[0],s[1])}this.scoreImg.update(this.isSuccess())}eventTouchmove(t){if(t.preventDefault(),this.welcome.count>3){let s=t.touches[0].clientX;var i=(this.lastx-s)*this.scale;if(console.log("移动"+i),this.bg.isIntheExtent(i)){this.bg.update(i);for(var e=0;e<this.spritesForType2.length;e++)this.spritesForType2[e].update(i);this.fail.update(i),this.fly.update(i),this.rightwindow.update(i),this.lastx=s}}}removeAllTouchListner(){if(canvas.removeEventListener("touchstart",this.touchstart),canvas.removeEventListener("touchend",this.touchend),canvas.removeEventListener("touchmove",this.touchmove),void 0!==this.spritesForType2){for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].removeListener();this.fail.removeListener(),this.fly.removeListener(),this.rightwindow.removeListener()}}},Ct,new class{constructor(){this.aniId=0,this.MissionId=2,this.personalHighScore=null,this.scale=1920/vt,this.keyImg="./images/Mission3/object.png",this.lastx=0,this.init()}init(){var t=[[[1,789],[0,0],[502,1],[1,320]],[[546,480],[0,0],[502,933],[749,958]],[[546,279],[0,0],[1003,933],[1,639]],[[546,1],[0,0],[502,933],[749,320]],[[546,1],[0,0],[502,933],[749,320]],[[546,1],[0,0],[502,933],[749,320]],[[1,400],[1,400],[1,1],[1,958]],[[398,1],[0,0],[1504,1],[749,639]],[[375,690],[0,0],[1,933],[749,1]]],i=[[182,131,-5,0,0],[181,181,4,2.65,1],[161,199,5.5,.6,1],[168,276,1,3.5,1],[168,276,-2,3.5,1],[168,276,-5,3.5,1],[372,387,-1,.8,0],[146,687,-13,.2,1],[191,257,-5,2,1]];this.isReturn=-1,this.bg=new r(pt,"images/Mission3/BG.png",4012,1920,1580);for(var e=[],s=0;s<t.length;s++){var n=new b(this.keyImg,t[s][0],i[s],t[s][2],t[s][3],t[s][1]);e.push(n)}this.spritesForType2=e,this.fail=new b("./images/Mission3/object.png",[1,1],[395,397,3,1,1],[0,0],[-1,-1],[-1,-1]),this.player=new g("./images/Mission3/person.png",1,1,499,930,499/this.scale,930/this.scale,0,.5),this.welcome=new l("./images/Mission3/word.png",[[1,958],[749,958]],"./images/Mission3/word.png",[.3,.7],746,317),this.returnBtn=new L("images/setting/Setting.png",[422,2],124,124,[0,0]),this.scoreImg=new O(1)}restart(){this.isReturn=-1,this.welcome.count=0,this.scores=[0,0,0,0,0],this.bindLoop=this.loop.bind(this);for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].init();this.fail.init(),this.hasEventBind=!1,this.bg.init(),this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.initevent()}render(){if(1==this.isReturn&&(this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),ct.restart()),pt.clearRect(0,0,canvas.width,canvas.height),this.isSuccess()<this.scores.length){this.bg.render(pt),this.fail.drawToCanvas(pt);for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].drawToCanvas(pt);this.welcome.drawToCanvas(pt),this.player.drawToCanvas(pt),this.scoreImg.drawToCanvas(pt)}else this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),At.init("./images/extra/complete3.png",this.MissionId),canvas.addEventListener("touchstart",At.touchstart);if(this.fail.touched&&(this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),At.init("./images/extra/fail3.png",this.MissionId),canvas.addEventListener("touchstart",At.touchstart)),2==this.welcome.count){for(t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].initEvent();this.fail.initEvent(),this.welcome.count++}this.returnBtn.drawToCanvas(pt)}completetouch(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.completeScene.again.checkIsFingerOnThis(i,e)&&(canvas.removeEventListener("touchstart",this.touchstart),this.restart())}loop(){this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.render()}initevent(){this.touchstart=this.eventTouchstart.bind(this),canvas.addEventListener("touchstart",this.touchstart),this.touchend=this.eventTouchend.bind(this),canvas.addEventListener("touchend",this.touchend),this.touchmove=this.eventTouchmove.bind(this),canvas.addEventListener("touchmove",this.touchmove)}isSuccess(){var t=0;return this.scores.forEach(function(i){t+=i}),t}eventTouchstart(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.lastx=i,this.returnBtn.checkIsFingerOnThis(i,e)&&(this.isReturn=1)}eventTouchend(t){t.preventDefault();var i=-1;if(this.welcome.count<2)this.welcome.count<1?this.welcome.update([.4,.3]):this.welcome.update([.3,.7]);else{for(var e=[-1,-1],s=[-1,-1],n=!1,h=0;h<this.spritesForType2.length;h++)1==this.spritesForType2[h].isClearance&&5!=h&&4!=h&&i++,this.spritesForType2[h].touched&&(1==this.spritesForType2[h].isClearance&&(this.scores[i]=1),e=this.spritesForType2[h].person,s=this.spritesForType2[h].words,n=!0);n||(i++,i++),this.player.update(e[0],e[1]),this.welcome.update([.3,.7],s[0],s[1])}this.scoreImg.update(this.isSuccess())}eventTouchmove(t){if(t.preventDefault(),this.welcome.count>1){let s=t.touches[0].clientX;var i=(this.lastx-s)*this.scale;if(console.log("移动"+i),this.bg.isIntheExtent(i)){this.bg.update(i);for(var e=0;e<this.spritesForType2.length;e++)this.spritesForType2[e].update(i);this.fail.update(i),this.lastx=s}}}removeAllTouchListner(){if(canvas.removeEventListener("touchstart",this.touchstart),canvas.removeEventListener("touchend",this.touchend),canvas.removeEventListener("touchmove",this.touchmove),void 0!==this.spritesForType2){for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].removeListener();this.fail.removeListener()}}},new class{constructor(){this.aniId=0,this.MissionId=3,this.personalHighScore=null,this.scale=1920/wt,this.keyImg="./images/Mission4/object.png",this.lastx=0,this.init()}init(){var t=[[[1,911],[0,0],[1,890],[749,639]],[[477,576],[0,0],[801,890],[1,1]],[[265,850],[0,0],[401,890],[749,320]],[[753,576],[0,0],[401,1],[1,639]],[[265,1],[0,0],[801,1],[1,958]],[[1,1],[0,0],[1201,1],[749,958]],[[1051,1],[0,0],[1,1],[1,1277]]],i=[[85,46,-21.9,-5.9,0],[274,266,-4.73,2.88,1],[406,138,2.2,3.3,1],[370,229,2.5,-2.5,1],[784,573,.8,0,1],[262,908,-9,.4,0],[133,565,-6,.6,1]];this.isReturn=-1,this.bg=new r(gt,"images/Mission4/BG.png",4012,1920,2e3);for(var e=[],s=0;s<t.length;s++){var n=new b(this.keyImg,t[s][0],i[s],t[s][2],t[s][3],t[s][1]);e.push(n)}this.spritesForType2=e,this.fail=new b("./images/Mission4/object.png",[265,576],[210,272,-6.67,.8,1],[0,0],[-1,-1],[-1,-1]),this.player=new g("./images/Mission4/person.png",1,1,398,887,400/this.scale,930/this.scale,0,.5),this.welcome=new l("./images/Mission4/word.png",[[1,320],[749,320]],"./images/Mission4/word.png",[.3,.7],746,317),this.returnBtn=new L("images/setting/Setting.png",[422,2],124,124,[0,0]),this.scoreImg=new O(1)}restart(){this.isReturn=-1,this.welcome.count=0,this.scores=[0,0,0,0,0],this.bindLoop=this.loop.bind(this);for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].init();this.fail.init(),this.hasEventBind=!1,this.bg.init(),this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.initevent()}render(){if(1==this.isReturn&&(this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),ct.restart()),gt.clearRect(0,0,canvas.width,canvas.height),this.isSuccess()<this.scores.length){this.bg.render(gt),this.fail.drawToCanvas(gt);for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].drawToCanvas(gt);this.welcome.drawToCanvas(gt),this.player.drawToCanvas(gt),this.scoreImg.drawToCanvas(gt)}else this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),At.init("./images/extra/complete4.png",this.MissionId),canvas.addEventListener("touchstart",At.touchstart);if(this.fail.touched&&(this.removeAllTouchListner(),window.cancelAnimationFrame(this.aniId),At.init("./images/extra/fail4.png",this.MissionId),canvas.addEventListener("touchstart",At.touchstart)),2==this.welcome.count){for(t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].initEvent();this.fail.initEvent(),this.welcome.count++}this.returnBtn.drawToCanvas(gt)}completetouch(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.completeScene.again.checkIsFingerOnThis(i,e)&&(canvas.removeEventListener("touchstart",this.touchstart),this.restart())}loop(){this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.render()}initevent(){this.touchstart=this.eventTouchstart.bind(this),canvas.addEventListener("touchstart",this.touchstart),this.touchend=this.eventTouchend.bind(this),canvas.addEventListener("touchend",this.touchend),this.touchmove=this.eventTouchmove.bind(this),canvas.addEventListener("touchmove",this.touchmove)}isSuccess(){var t=0;return this.scores.forEach(function(i){t+=i}),t}eventTouchstart(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.lastx=i,this.returnBtn.checkIsFingerOnThis(i,e)&&(this.isReturn=1)}eventTouchend(t){t.preventDefault();var i=-1;if(this.welcome.count<2)this.welcome.count<1?this.welcome.update([.4,.3]):this.welcome.update([.3,.7]);else{for(var e=[-1,-1],s=[-1,-1],n=!1,h=0;h<this.spritesForType2.length;h++)1==this.spritesForType2[h].isClearance&&i++,this.spritesForType2[h].touched&&(1==this.spritesForType2[h].isClearance&&(this.scores[i]=1),e=this.spritesForType2[h].person,s=this.spritesForType2[h].words,n=!0);n||(i++,i++),this.player.update(e[0],e[1]),this.welcome.update([.3,.7],s[0],s[1])}this.scoreImg.update(this.isSuccess())}eventTouchmove(t){if(t.preventDefault(),this.welcome.count>1){let s=t.touches[0].clientX;var i=(this.lastx-s)*this.scale;if(console.log("移动"+i),this.bg.isIntheExtent(i)){this.bg.update(i);for(var e=0;e<this.spritesForType2.length;e++)this.spritesForType2[e].update(i);this.fail.update(i),this.lastx=s}}}removeAllTouchListner(){if(canvas.removeEventListener("touchstart",this.touchstart),canvas.removeEventListener("touchend",this.touchend),canvas.removeEventListener("touchmove",this.touchmove),void 0!==this.spritesForType2){for(var t=0;t<this.spritesForType2.length;t++)this.spritesForType2[t].removeListener();this.fail.removeListener()}}}],At=new class{constructor(){this.atlas=new Image}init(t,i){this.missionId=i,this.clickType=-1,this.atlas.src=t,this.again=new L("images/extra/btnsprite.png",[1462,164],407,122,[.05,.3]),this.next=new L("images/extra/btnsprite.png",[1053,164],407,122,[.55,.3]),this.getCet=new L("images/extra/btnsprite.png",[1,181],407,122,[.3,.4]),this.touchstart=this.completetouch.bind(this),this.bindLoop=this.loop.bind(this),this.aniId=window.requestAnimationFrame(this.bindLoop,canvas)}loop(){this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.render()}render(){xt.drawImage(this.atlas,0,0,1080,1920,0,0,1080/ft,1920/bt),this.again.drawToCanvas(xt),this.next.drawToCanvas(xt),this.getCet.drawToCanvas(xt),0==this.clickType?(window.cancelAnimationFrame(this.aniId),canvas.removeEventListener("touchstart",At.touchstart),Mt[At.missionId].restart()):1==At.clickType&&(window.cancelAnimationFrame(this.aniId),canvas.removeEventListener("touchstart",At.touchstart),At.missionId<2?Mt[At.missionId+1].restart():ct.restart())}completetouch(t){t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;console.log(At.clickType),At.again.checkIsFingerOnThis(i,e)&&(At.clickType=0),At.next.checkIsFingerOnThis(i,e)&&(At.clickType=1)}},St=new class{init(){this.atlas=new Image,this.atlas.src=ut,this.point=new Image,this.point.src="./images/extra/point.png",this.pointx=-1,this.pointy=-1,this.pointShow=0,kt.playBgm(),this.start=new L("./images/Begin/start.png",[0,0],910,361,[.08,.7]),this.start.drawToCanvas(dt),this.isStart=0,this.bindLoop=this.loop.bind(this),this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.touchstart=this.completetouch.bind(this),canvas.addEventListener("touchstart",this.touchstart),this.pointstart=this.pointtouch.bind(this),canvas.addEventListener("touchstart",this.pointstart),this.pointmove=this.touchmove.bind(this),canvas.addEventListener("touchstart",this.pointmove)}loop(){this.aniId=window.requestAnimationFrame(this.bindLoop,canvas),this.render()}completetouch(t){console.log(1),t.preventDefault();let i=t.touches[0].clientX,e=t.touches[0].clientY;this.start.checkIsFingerOnThis(i,e)&&(this.isStart=1)}pointtouch(t){t.preventDefault(),kt.playShoot(),this.pointx=t.touches[0].clientX,this.pointy=t.touches[0].clientY}touchmove(t){t.preventDefault(),this.pointx=t.touches[0].clientX,this.pointy=t.touches[0].clientY,dt.drawImage(this.point,this.pointx,this.pointy)}render(){0==this.isStart&&(dt.drawImage(this.atlas,0,0,1080,1920,0,0,1080/at,1920/rt),this.start.drawToCanvas(dt)),this.pointShow>0&&(this.pointShow--,dt.drawImage(this.point,this.pointx,this.pointy)),1==this.isStart&&(this.isStart=2,canvas.removeEventListener("touchstart",this.touchstart),canvas.addEventListener("touchstart",this.pointstart),ct.init())}},kt=new class{constructor(){if(It)return It;It=this,this.bgmAudio=new Audio,this.bgmAudio.loop=!0,this.bgmAudio.src="audio/bgm.mp3",this.shootAudio=new Audio,this.shootAudio.src="audio/click.mp3",this.isPlayBgm=1,this.isPlayShoot=1,this.playBgm()}playBgm(){1==this.isPlayBgm?this.bgmAudio.play():this.bgmAudio.pause()}playShoot(){1==this.isPlayShoot&&(this.shootAudio.currentTime=0,this.shootAudio.play())}playExplosion(){this.boomAudio.currentTime=0,this.boomAudio.play()}};St.init()}]);